version: 1.0.{build}
image: Visual Studio 2019 Preview
configuration: Release

init:
- pwsh: if(test-path -LiteralPath ./ci.build.init.ps1){. ./ci.build.init.ps1}

install:
   # .NET Core SDK binaries
   # full url can be found in release notes (ex. https://github.com/dotnet/core/blob/master/release-notes/3.0/preview/3.0.0-preview8.md)
   - ps: $urlCurrent = "https://dotnetcli.azureedge.net/dotnet/Sdk/3.0.100-preview8-013656/dotnet-sdk-3.0.100-preview8-013656-win-x64.zip"
   - ps: $env:DOTNET_INSTALL_DIR = "$pwd\.dotnetsdk"
   - ps: mkdir $env:DOTNET_INSTALL_DIR -Force | Out-Null
   - ps: $tempFileCurrent = [System.IO.Path]::Combine([System.IO.Path]::GetTempPath(), [System.IO.Path]::GetRandomFileName())
   - ps: (New-Object System.Net.WebClient).DownloadFile($urlCurrent, $tempFileCurrent)
   - ps: Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::ExtractToDirectory($tempFileCurrent, $env:DOTNET_INSTALL_DIR)
   - ps: $env:Path = "$env:DOTNET_INSTALL_DIR;$env:Path"

before_build:
  - dotnet restore

build:
  project: SayedHa.Commands.sln
  publish_core_console: true
  verbosity: normal

after_build:
  - dotnet pack SayedHa.Commands/SayedHa.Commands.csproj

artifacts:
- path: '**\nupkg\*.nupkg'